<!DOCTYPE html><html lang="en"><head><script type="module" src="index.c50deec8.js"></script><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" type="text/css" href="index.3c56c6a0.css"><link rel="stylesheet" type="text/css" href="index.3e79c1fb.css"><title>睿几何设计平台</title><link rel="icon" type="image/x-icon" href="favicon.7b6df606.ico"></head><script src="index.bfd37a17.js"></script><script src="index.4c4fe260.js"></script><script src="index.5189e60f.js"></script><script src="index.33b8bc38.js"></script><script type="module" src="index.cce90428.js"></script><script type="module" src="index.ed343f24.js"></script><body> <script type="module">var t={};t=new URL("mini_cycles.67867ca1.wasm",import.meta.url).toString();var n=(()=>{var n="file:///src2/web3d/wasm/mini_cycles.js";return function(e){var r,i,a,o,s,u,l,c,_,f,h,m,p,g,y=void 0!==(e=e||{})?e:{};y.ready=new Promise(function(t,n){i=t,a=n});var d=Object.assign({},y),w=[],v="";"undefined"!=typeof document&&document.currentScript&&(v=document.currentScript.src),n&&(v=n),v=0!==v.indexOf("blob:")?v.substr(0,v.replace(/[?#].*/,"").lastIndexOf("/")+1):"";var A=y.print||console.log.bind(console),b=y.printErr||console.warn.bind(console);Object.assign(y,d),d=null,y.arguments&&(w=y.arguments),y.thisProgram&&y.thisProgram,y.quit&&y.quit,y.wasmBinary&&(s=y.wasmBinary),y.noExitRuntime,"object"!=typeof WebAssembly&&F("no native wasm support detected");var x=!1;function S(t,n,e,r,i){var a,o,s={string:function(t){var n=0;if(null!=t&&0!==t){var e=(t.length<<2)+1;!function(t,n,e,r){if(r>0){for(var i=e+r-1,a=0;a<t.length;++a){var o=t.charCodeAt(a);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&t.charCodeAt(++a)),o<=127){if(e>=i)break;n[e++]=o}else if(o<=2047){if(e+1>=i)break;n[e++]=192|o>>6,n[e++]=128|63&o}else if(o<=65535){if(e+2>=i)break;n[e++]=224|o>>12,n[e++]=128|o>>6&63,n[e++]=128|63&o}else{if(e+3>=i)break;n[e++]=240|o>>18,n[e++]=128|o>>12&63,n[e++]=128|o>>6&63,n[e++]=128|63&o}}n[e]=0}}(t,_,n=K(e),e)}return n},array:function(t){var n=K(t.length);return c.set(t,n),n}},u=y["_"+t],l=[],f=0;if(r)for(var h=0;h<r.length;h++){var m=s[e[h]];m?(0===f&&(f=G()),l[h]=m(r[h])):l[h]=r[h]}var p=u.apply(null,l);return o=p,0!==f&&J(f),p="string"===n?o?E(_,o,a):"":"boolean"===n?!!o:o}var R="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function E(t,n,e){for(var r=n+e,i=n;t[i]&&!(i>=r);)++i;if(i-n>16&&t.buffer&&R)return R.decode(t.subarray(n,i));for(var a="";n<i;){var o=t[n++];if(!(128&o)){a+=String.fromCharCode(o);continue}var s=63&t[n++];if((224&o)==192){a+=String.fromCharCode((31&o)<<6|s);continue}var u=63&t[n++];if((o=(240&o)==224?(15&o)<<12|s<<6|u:(7&o)<<18|s<<12|u<<6|63&t[n++])<65536)a+=String.fromCharCode(o);else{var l=o-65536;a+=String.fromCharCode(55296|l>>10,56320|1023&l)}}return a}function I(t){l=t,y.HEAP8=c=new Int8Array(t),y.HEAP16=new Int16Array(t),y.HEAP32=f=new Int32Array(t),y.HEAPU8=_=new Uint8Array(t),y.HEAPU16=new Uint16Array(t),y.HEAPU32=h=new Uint32Array(t),y.HEAPF32=new Float32Array(t),y.HEAPF64=new Float64Array(t)}y.INITIAL_MEMORY;var P=[],C=[],D=[],k=0,O=null,j=null;function F(t){y.onAbort&&y.onAbort(t),b(t="Aborted("+t+")"),x=!0,t+=". Build with -sASSERTIONS for more info.";var n=new WebAssembly.RuntimeError(t);throw a(n),n}function M(t){return t.startsWith("data:application/octet-stream;base64,")}function T(t){try{if(t==p&&s)return new Uint8Array(s);if(o)return o(t);throw"both async and sync fetching of the wasm failed"}catch(t){F(t)}}function H(t){for(;t.length>0;){var n=t.shift();if("function"==typeof n){n(y);continue}var e=n.func;"number"==typeof e?void 0===n.arg?W(e)():W(e)(n.arg):e(void 0===n.arg?null:n.arg)}}y.locateFile?M(p="mini_cycles.wasm")||(r=p,p=y.locateFile?y.locateFile(r,v):v+r):p=new URL(t).toString();var B=[];function W(t){var n=B[t];return n||(t>=B.length&&(B.length=t+1),B[t]=n=m.get(t)),n}function U(t){this.excPtr=t,this.ptr=t-24,this.set_type=function(t){h[this.ptr+4>>2]=t},this.get_type=function(){return h[this.ptr+4>>2]},this.set_destructor=function(t){h[this.ptr+8>>2]=t},this.get_destructor=function(){return h[this.ptr+8>>2]},this.set_refcount=function(t){f[this.ptr>>2]=t},this.set_caught=function(t){t=t?1:0,c[this.ptr+12>>0]=t},this.get_caught=function(){return 0!=c[this.ptr+12>>0]},this.set_rethrown=function(t){t=t?1:0,c[this.ptr+13>>0]=t},this.get_rethrown=function(){return 0!=c[this.ptr+13>>0]},this.init=function(t,n){this.set_adjusted_ptr(0),this.set_type(t),this.set_destructor(n),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var t=f[this.ptr>>2];f[this.ptr>>2]=t+1},this.release_ref=function(){var t=f[this.ptr>>2];return f[this.ptr>>2]=t-1,1===t},this.set_adjusted_ptr=function(t){h[this.ptr+16>>2]=t},this.get_adjusted_ptr=function(){return h[this.ptr+16>>2]},this.get_exception_ptr=function(){if(Q(this.get_type()))return h[this.excPtr>>2];var t=this.get_adjusted_ptr();return 0!==t?t:this.excPtr}}var L=0,q=[null,[],[]],z={varargs:void 0,get:function(){return z.varargs+=4,f[z.varargs-4>>2]},getStr:function(t){return t?E(_,t,void 0):""}},N={c:function(t){return Y(t+24)+24},b:function(t,n,e){throw new U(t).init(n,e),L++,t},d:function(){F("")},f:function(t,n,e){_.copyWithin(t,n,n+e)},e:function(t){var n=_.length;if((t>>>=0)>2147483648)return!1;let e=(t,n)=>t+(n-t%n)%n;for(var r=1;r<=4;r*=2){var i=n*(1+.2/r);if(i=Math.min(i,t+100663296),function(t){try{return u.grow(t-l.byteLength+65535>>>16),I(u.buffer),1}catch(t){}}(Math.min(2147483648,e(Math.max(t,i),65536))))return!0}return!1},a:function(t,n,e,r){for(var i=0,a=0;a<e;a++){var o=h[n>>2],s=h[n+4>>2];n+=8;for(var u=0;u<s;u++)!function(t,n){var e=q[t];0===n||10===n?((1===t?A:b)(E(e,0)),e.length=0):e.push(n)}(t,_[o+u]);i+=s}return h[r>>2]=i,0}};!function(){var t={a:N};function n(t,n){var e,r=t.exports;y.asm=r,I((u=y.asm.g).buffer),m=y.asm.l,e=y.asm.h,C.unshift(e),function(t){if(k--,y.monitorRunDependencies&&y.monitorRunDependencies(k),0==k&&(null!==O&&(clearInterval(O),O=null),j)){var n=j;j=null,n()}}(0)}function e(t){n(t.instance)}function r(n){return(s||"function"!=typeof fetch?Promise.resolve().then(function(){return T(p)}):fetch(p,{credentials:"same-origin"}).then(function(t){if(!t.ok)throw"failed to load wasm binary file at '"+p+"'";return t.arrayBuffer()}).catch(function(){return T(p)})).then(function(n){return WebAssembly.instantiate(n,t)}).then(function(t){return t}).then(n,function(t){b("failed to asynchronously prepare wasm: "+t),F(t)})}if(k++,y.monitorRunDependencies&&y.monitorRunDependencies(k),y.instantiateWasm)try{return y.instantiateWasm(t,n)}catch(t){return b("Module.instantiateWasm callback failed with error: "+t),!1}(s||"function"!=typeof WebAssembly.instantiateStreaming||M(p)||"function"!=typeof fetch?r(e):fetch(p,{credentials:"same-origin"}).then(function(n){return WebAssembly.instantiateStreaming(n,t).then(e,function(t){return b("wasm streaming compile failed: "+t),b("falling back to ArrayBuffer instantiation"),r(e)})})).catch(a)}(),y.___wasm_call_ctors=function(){return(y.___wasm_call_ctors=y.asm.h).apply(null,arguments)},y._is_planar=function(){return(y._is_planar=y.asm.i).apply(null,arguments)},y._get_minicycles=function(){return(y._get_minicycles=y.asm.j).apply(null,arguments)};var Y=y._malloc=function(){return(Y=y._malloc=y.asm.k).apply(null,arguments)},G=(y._free=function(){return(y._free=y.asm.m).apply(null,arguments)},y.stackSave=function(){return(G=y.stackSave=y.asm.n).apply(null,arguments)}),J=y.stackRestore=function(){return(J=y.stackRestore=y.asm.o).apply(null,arguments)},K=y.stackAlloc=function(){return(K=y.stackAlloc=y.asm.p).apply(null,arguments)},Q=y.___cxa_is_pointer_type=function(){return(Q=y.___cxa_is_pointer_type=y.asm.q).apply(null,arguments)};function V(t){t=t||w,!(k>0)&&(function(){if(y.preRun)for("function"==typeof y.preRun&&(y.preRun=[y.preRun]);y.preRun.length;){var t;t=y.preRun.shift(),P.unshift(t)}H(P)}(),k>0||(y.setStatus?(y.setStatus("Running..."),setTimeout(function(){setTimeout(function(){y.setStatus("")},1),n()},1)):n()));function n(){!g&&(g=!0,y.calledRun=!0,x||(H(C),i(y),y.onRuntimeInitialized&&y.onRuntimeInitialized(),function(){if(y.postRun)for("function"==typeof y.postRun&&(y.postRun=[y.postRun]);y.postRun.length;){var t;t=y.postRun.shift(),D.unshift(t)}H(D)}()))}}if(y.ccall=S,y.cwrap=function(t,n,e,r){var i=(e=e||[]).every(function(t){return"number"===t});return"string"!==n&&i&&!r?y["_"+t]:function(){return S(t,n,e,arguments,r)}},j=function t(){g||V(),g||(j=t)},y.run=V,y.preInit)for("function"==typeof y.preInit&&(y.preInit=[y.preInit]);y.preInit.length>0;)y.preInit.pop()();return V(),e.ready}})();!function(t,e){"use strict";var r,i=function(){return f.__string_rec(this,"")},a=a||{};Math.__name__=!0;class o{static string(t){return f.__string_rec(t,"")}}o.__name__=!0;class s extends Error{constructor(t,n,e){super(t),this.message=t,this.__previousException=n,this.__nativeException=null!=e?e:this}get_native(){return this.__nativeException}static thrown(t){return t instanceof s?t.get_native():t instanceof Error?t:new u(t)}}s.__name__=!0;class u extends s{constructor(t,n,e){super(String(t),n,e),this.value=t}}u.__name__=!0;var l=a["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:i},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:i},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:i},Custom:((r=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:i}})._hx_name="Custom",r.__params__=["e"],r)};l.__constructs__=[l.Blocked,l.Overflow,l.OutsideBounds,l.Custom];class c{static fromArray(t,n,e){if(null==n&&(n=0),null==e&&(e=t.length-n),n<0||e<0||n+e>t.length)throw s.thrown(l.OutsideBounds);if(0==n&&e==t.length)return new Float32Array(t);let r=new Float32Array(t.length),i=0,a=e;for(;i<a;){let e=i++;r[e]=t[e+n]}return r}}class _{static fromArray(t,n,e){if(null==n&&(n=0),null==e&&(e=t.length-n),n<0||e<0||n+e>t.length)throw s.thrown(l.OutsideBounds);if(0==n&&e==t.length)return new Int32Array(t);let r=new Int32Array(t.length),i=0,a=e;for(;i<a;){let e=i++;r[e]=t[e+n]}return r}}class f{static __string_rec(t,n){if(null==t)return"null";if(n.length>=5)return"<...>";let e=typeof t;switch("function"==e&&(t.__name__||t.__ename__)&&(e="object"),e){case"function":return"<function>";case"object":let r;if(t.__enum__){let e=a[t.__enum__].__constructs__[t._hx_index],r=e._hx_name;if(e.__params__)return n+="	",r+"("+(function(r){let i=[];{let r=0,a=e.__params__;for(;r<a.length;){let e=a[r];r+=1,i.push(f.__string_rec(t[e],n))}}return i})(0).join(",")+")";return r}if(t instanceof Array){let e="[";n+="	";let r=0,i=t.length;for(;r<i;){let i=r++;e+=(i>0?",":"")+f.__string_rec(t[i],n)}return e+"]"}try{r=t.toString}catch(t){return"???"}if(null!=r&&r!=Object.toString&&"function"==typeof r){let n=t.toString();if("[object Object]"!=n)return n}let i="{\n";n+="	";let o=null!=t.hasOwnProperty,s=null;for(s in t)(!o||t.hasOwnProperty(s))&&"prototype"!=s&&"__class__"!=s&&"__super__"!=s&&"__interfaces__"!=s&&"__properties__"!=s&&(2!=i.length&&(i+=", \n"),i+=n+s+" : "+f.__string_rec(t[s],n));return i+("\n"+(n=n.substring(1)))+"}";case"string":return t;default:return String(t)}}}f.__name__=!0;class h{static mallocInt2Array(t,n){let e=h.flattenArray(t),r=_.fromArray(e),i=n._malloc(4*r.length);return n.HEAP32.set(r,i/4|0),{ptr:i,length:e.length}}static mallocFloat2Array(t,n){let e=h.flattenArray(t),r=c.fromArray(e),i=n._malloc(4*r.length);return n.HEAPF32.set(r,i/4|0),{ptr:i,length:e.length}}static mallocDouble2Array(t,n){let e=h.flattenArray(t),r=Float64Array.from(e),i=n._malloc(8*r.length);return n.HEAPF64.set(r,i/8|0),{ptr:i,length:e.length}}static fromPointerToArrayInt2(t,n){let e=n/4,r=t.HEAP32.subarray(e,e+1);if(0==r)return[];let i=(0|e)+(0|r),a=t.HEAP32.subarray(e+1,i);return h.unFlattenArray(a)}static flattenArray(t){let n=[],e=0;for(;e<t.length;){let r=t[e];++e;let i=r.length;n.push(i);let a=0;for(;a<i;){let t=a++;n.push(r[t])}}return n}static unFlattenArray(t){let n=[],e=0;for(;e<t.length;){let r=t[e],i=[],a=0;for(;a<r;){let n=a++;i.push(t[e+n+1])}n.push(i),e+=r+1}return n}}h.__name__=!0;class m{static main(){console.log("src/wasm/MiniCycles.hx:18:","wasm"+o.string(m.module)),window.MiniCycles=m,console.log("src/wasm/MiniCycles.hx:22:",m)}static async init(t){if(null==m.module){let e=new n;m.module=await e,m.wasInit=!0,null!=t&&t()}}static getModule(){return m.wasInit}static is_planar(t,n){let e=new Date().getTime(),r=h.mallocDouble2Array(t,m.module),i=h.mallocInt2Array(n,m.module),a=m.module.cwrap("is_planar","number",["number","number","number","number"])(r.ptr,r.length,i.ptr,i.length);return console.log("is_planar time:"+(new Date().getTime()-e)),m.module._free(r.ptr),m.module._free(i.ptr),1==a}static getResult(t,n){let e=new Date().getTime(),r=h.mallocDouble2Array(t,m.module),i=h.mallocInt2Array(n,m.module),a=m.module.cwrap("get_minicycles","number",["number","number","number","number"])(r.ptr,r.length,i.ptr,i.length);console.log("src/wasm/MiniCycles.hx:76:",a);let o=new Date().getTime();console.log("cpp 计算花费 time:"+(o-e)+"ms"),e=new Date().getTime();let s=h.fromPointerToArrayInt2(m.module,a);return console.log("js 转换花费 time:"+((o=new Date().getTime())-e)+"ms"),m.module._free(r.ptr),m.module._free(i.ptr),s}static test(){let t=[[11825.25,0],[11705.25,120.000244140625],[11585.25,240.000244140625],[0,0],[120,120.000244140625],[240,240.000244140625],[11825.25,7742.31005859375],[11705.25,7622.31005859375],[11585.25,7502.31005859375],[11825.25,4930.5401611328125],[11705.25,4930.5401611328125],[11585.25,5050.5401611328125],[11585.25,4810.5401611328125],[0,4930.5401611328125],[120,4930.5401611328125],[240,4870.5401611328125],[240,4990.5401611328125],[0,7742.31005859375],[120,7622.31005859375],[240,7502.31005859375],[5004.6402587890625,7742.31005859375],[5004.6402587890625,7622.31005859375],[4884.6402587890625,7502.31005859375],[5124.6402587890625,7502.31005859375],[4884.6402587890625,4990.5401611328125],[5004.6402587890625,4930.5401611328125],[5004.6402587890625,4870.5401611328125],[5124.6402587890625,5050.5401611328125],[5004.6402587890625,4810.5401611328125]],n=[[0,1],[1,2],[0,3],[2,5],[3,4],[4,5],[6,7],[7,8],[6,9],[8,11],[9,10],[10,11],[10,12],[9,0],[12,2],[3,13],[5,15],[13,14],[14,15],[14,16],[13,17],[16,19],[17,18],[18,19],[17,20],[19,22],[20,21],[21,22],[21,23],[20,6],[23,8],[16,24],[15,26],[24,25],[25,26],[27,25],[26,28],[27,11],[28,12],[23,27],[22,24]],e=new Date().getTime();m.is_planar(t,n);let r=m.getResult(t,n);console.log("src/wasm/MiniCycles.hx:143:","spend time: "+(new Date().getTime()-e)+"ms"),console.log("src/wasm/MiniCycles.hx:145:",r)}}t.MiniCycles=m,m.__name__=!0,String.__name__=!0,Array.__name__=!0,Date.__name__="Date",f.__toStr=({}).toString,m.wasInit=!1,m.main()}({},0),async function(){await MiniCycles.init(),window.editor.list.pluginList.dispatch("ok")}();</script> </body></html>